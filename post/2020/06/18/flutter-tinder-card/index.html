<!DOCTYPE html>
<html lang="zh">
  <head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="chrome=1" />
  <meta name="renderer" content="webkit|ie-comp|ie-stand" />
  <meta name="referrer" content="no-referrer" />
  <meta name="theme-color" content="#333333" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="google" content="notranslate" />
  <meta name="format-detection" content="telephone=no" />
  <meta name="keyword" content="冷石, 前端, 面试，Web, Js, CSS, Node.js, Frontend, Flutter, Docker, Dart, Mysql, Egg.js" />
  <meta name="description" content="孑然一身，傲立于世" />
  <title>冷石的博客</title>
  <base href="/" />
  <link rel="preconnect" href="//cdn.jsdelivr.net" />
  <link rel="shortcut icon" href="/icons/icon-72x72.png" />
  <link
    rel="apple-touch-icon"
    href="/icons/icon-192x192.png"
  />
  <link
    rel="stylesheet"
    href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.7.2/build/styles/atom-one-light.min.css"
  />
  <link rel="stylesheet" href="/index.css">
  <script
    data-ad-client="ca-pub-1196485898698315"
    async
    src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"
  ></script>
</head>

  <body>
    <header class="header">
  <a class="logo" href="/">
    <img
      class="logo-img"
      src="https://avatars.githubusercontent.com/u/18013127?v=4"
    />
  </a>
  <div class="color" id="color"></div>
</header>

    <main class=""><article class="container article">
    
      <div class="article-cover">
        <img decoding="async" loading="lazy" src="./images/flutter-tinder-card/cover.png" alt="cover" />
      </div>
    

    <h1 class="article-title">用 Flutter 实现探探卡片布局</h1>
 
    <p class="article-meta">
      <span class="article-meta-item">
        最后更新&#58;&nbsp;<time
          class="post-time"
          datetime="2021-06-28"
          >2021-06-28</time
        >
      </span>
      <span class="article-meta-item"
        >阅读时间&#58;&nbsp;14
        min</span
      >

    </p>
  </section>

  <section class=""><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>前几天写了一个 Fluter 插件 <a href="https://github.com/xrr2016/tcard" target="_blank" rel="noopener">tcard</a>，用来实现类似于探探卡片的布局。效果如下，本文讲解如何使用 <code>Stack</code> 控件实现这个布局。</p>
<img src="./images/flutter-tinder-card/images.gif" width="900" style="width: 500px">

<p><a href="https://dartpad.dev/efe152273d6835af5cec6d8f40ab0c58" target="_blank" rel="noopener">在线查看</a></p>
<h2 id="初识-Stack"><a href="#初识-Stack" class="headerlink" title="初识 Stack"></a>初识 Stack</h2><p><code>Stack</code> 是一个有多子项的控件，它会将自己的子项相对于自身边缘进行定位，后面的子项会覆盖前面的子项。通常用来实现将一个控件覆盖于另一个控件之上的布局，比如在一张图片上显示一些文字。子项的默认位置在 <code>Stack</code> 左上角，也可以用 <code>Align</code> 或者 <code>Positioned</code> 控件分别进行定位。</p>
<img src="https://flutter.github.io/assets-for-api-docs/assets/widgets/stack.png" style="width: 520px">

<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Stack(</span><br><span class="line">  children: &lt;Widget&gt;[</span><br><span class="line">    Container(</span><br><span class="line">      width: <span class="number">100</span>,</span><br><span class="line">      height: <span class="number">100</span>,</span><br><span class="line">      color: Colors.red,</span><br><span class="line">    ),</span><br><span class="line">    Container(</span><br><span class="line">      width: <span class="number">90</span>,</span><br><span class="line">      height: <span class="number">90</span>,</span><br><span class="line">      color: Colors.green,</span><br><span class="line">    ),</span><br><span class="line">    Container(</span><br><span class="line">      width: <span class="number">80</span>,</span><br><span class="line">      height: <span class="number">80</span>,</span><br><span class="line">      color: Colors.blue,</span><br><span class="line">    ),</span><br><span class="line">  ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><a href="https://youtu.be/liEGSeD3Zt8" target="_blank" rel="noopener">Stack (Flutter Widget of the Week)</a></p>
<h2 id="布局思路"><a href="#布局思路" class="headerlink" title="布局思路"></a>布局思路</h2><p>要使用 <code>Stack</code> 实现这个卡片布局的大致思路如下</p>
<ol>
<li>首先需要前，中，后三个子控件，使用 <code>Align</code> 控件定位在容器中。</li>
<li>需要一个手势监听器 <code>GestureDetector</code> 监听手指滑动。</li>
<li>监听手指在屏幕上滑动同时更新最前面卡片的位置。</li>
<li>判断移动的横轴距离进行卡片位置变换动画或者卡片回弹动画。</li>
<li>如果运行了卡片位置变换动画在动画结束后更新卡片的索引值。</li>
</ol>
<h2 id="卡片布局"><a href="#卡片布局" class="headerlink" title="卡片布局"></a>卡片布局</h2><ol>
<li>创建 <code>Stack</code> 容器以及前，中，后三个子控件</li>
</ol>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  _MyAppState createState() =&gt; _MyAppState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_MyAppState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">MyApp</span>&gt; </span>&#123;</span><br><span class="line">  <span class="comment">//  前面的卡片，使用 Align 定位</span></span><br><span class="line">  Widget _frontCard() &#123;</span><br><span class="line">    <span class="keyword">return</span> Align(</span><br><span class="line">      child: Container(</span><br><span class="line">        color: Colors.blue,</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 中间的卡片，使用 Align 定位</span></span><br><span class="line">  Widget _middleCard() &#123;</span><br><span class="line">    <span class="keyword">return</span> Align(</span><br><span class="line">      child: Container(</span><br><span class="line">        color: Colors.red,</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 后面的卡片，使用 Align 定位</span></span><br><span class="line">  Widget _backCard() &#123;</span><br><span class="line">    <span class="keyword">return</span> Align(</span><br><span class="line">      child: Container(</span><br><span class="line">        color: Colors.green,</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> MaterialApp(</span><br><span class="line">      title: <span class="string">'TCards demo'</span>,</span><br><span class="line">      debugShowCheckedModeBanner: <span class="keyword">false</span>,</span><br><span class="line">      home: Scaffold(</span><br><span class="line">        body: Center(</span><br><span class="line">          child: SizedBox(</span><br><span class="line">            width: <span class="number">300</span>,</span><br><span class="line">            height: <span class="number">400</span>,</span><br><span class="line">            child: Stack(</span><br><span class="line">              children: [</span><br><span class="line">                <span class="comment">// 后面的子项会显示在上面，所以前面的卡片放在最后</span></span><br><span class="line">                _backCard(),</span><br><span class="line">                _middleCard(),</span><br><span class="line">                _frontCard(),</span><br><span class="line">              ],</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="./images/flutter-tinder-card/stack.png" width="560" style="width: 280px">

<ol start="2">
<li>对子控件分别定位并设置其尺寸</li>
</ol>
<p>定位需要设置 <code>Align</code> 控件的 alignment 属性，传入一个 <code>Alignment(x, y)</code> 进行设置。设置尺寸需要使用 <code>LayoutBuilder</code> 获取当前父容器的尺寸，然后根据容器尺寸进行计算。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_MyAppState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">MyApp</span>&gt; </span>&#123;</span><br><span class="line">  <span class="comment">//  前面的卡片，使用 Align 定位</span></span><br><span class="line">  Widget _frontCard(BoxConstraints constraints) &#123;</span><br><span class="line">    <span class="keyword">return</span> Align(</span><br><span class="line">      alignment: Alignment(<span class="number">0.0</span>, <span class="number">-0.5</span>),</span><br><span class="line">      <span class="comment">// 使用 SizedBox 确定卡片尺寸</span></span><br><span class="line">      child: SizedBox.fromSize(</span><br><span class="line">        <span class="comment">// 计算卡片尺寸，相对于父容器</span></span><br><span class="line">        size: Size(constraints.maxWidth * <span class="number">0.9</span>, constraints.maxHeight * <span class="number">0.9</span>),</span><br><span class="line">        child: Container(</span><br><span class="line">          color: Colors.blue,</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 中间的卡片，使用 Align 定位</span></span><br><span class="line">  Widget _middleCard(BoxConstraints constraints) &#123;</span><br><span class="line">    <span class="keyword">return</span> Align(</span><br><span class="line">      alignment: Alignment(<span class="number">0.0</span>, <span class="number">0.0</span>),</span><br><span class="line">      child: SizedBox.fromSize(</span><br><span class="line">        <span class="comment">// 计算卡片尺寸，相对于父容器</span></span><br><span class="line">        size: Size(constraints.maxWidth * <span class="number">0.85</span>, constraints.maxHeight * <span class="number">0.9</span>),</span><br><span class="line">        child: Container(</span><br><span class="line">          color: Colors.red,</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 后面的卡片，使用 Align 定位</span></span><br><span class="line">  Widget _backCard(BoxConstraints constraints) &#123;</span><br><span class="line">    <span class="keyword">return</span> Align(</span><br><span class="line">      alignment: Alignment(<span class="number">0.0</span>, <span class="number">0.5</span>),</span><br><span class="line">      child: SizedBox.fromSize(</span><br><span class="line">        <span class="comment">// 计算卡片尺寸，相对于父容器</span></span><br><span class="line">        size: Size(constraints.maxWidth * <span class="number">0.8</span>, constraints.maxHeight * <span class="number">.9</span>),</span><br><span class="line">        child: Container(</span><br><span class="line">          color: Colors.green,</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> MaterialApp(</span><br><span class="line">      title: <span class="string">'TCards demo'</span>,</span><br><span class="line">      debugShowCheckedModeBanner: <span class="keyword">false</span>,</span><br><span class="line">      home: Scaffold(</span><br><span class="line">        body: Center(</span><br><span class="line">          child: SizedBox(</span><br><span class="line">            width: <span class="number">300</span>,</span><br><span class="line">            height: <span class="number">400</span>,</span><br><span class="line">            child: LayoutBuilder(</span><br><span class="line">              builder: (context, constraints) &#123;</span><br><span class="line">                <span class="comment">// 使用 LayoutBuilder 获取容器的尺寸，传个子项计算卡片尺寸</span></span><br><span class="line">                <span class="keyword">return</span> Stack(</span><br><span class="line">                  children: [</span><br><span class="line">                    <span class="comment">// 后面的子项会显示在上面，所以前面的卡片放在最后</span></span><br><span class="line">                    _backCard(constraints),</span><br><span class="line">                    _middleCard(constraints),</span><br><span class="line">                    _frontCard(constraints),</span><br><span class="line">                  ],</span><br><span class="line">                );</span><br><span class="line">              &#125;,</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="./images/flutter-tinder-card/align.png" width="560" style="width: 280px">

<ol start="3">
<li>更新最前面卡片位置</li>
</ol>
<p>向 <code>Stack</code> 容器添加一个 <code>GestureDetector</code>，手指在屏幕上移动时更新最前面卡片的位置。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_MyAppState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">MyApp</span>&gt; </span>&#123;</span><br><span class="line">  <span class="comment">// 保存最前面卡片的定位</span></span><br><span class="line">  Alignment _frontCardAlignment = Alignment(<span class="number">0.0</span>, <span class="number">-0.5</span>);</span><br><span class="line">  <span class="comment">// 保存最前面卡片的旋转角度</span></span><br><span class="line">  <span class="built_in">double</span> _frontCardRotation = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//  前面的卡片，使用 Align 定位</span></span><br><span class="line">  Widget _frontCard(BoxConstraints constraints) &#123;</span><br><span class="line">    <span class="keyword">return</span> Align(</span><br><span class="line">      alignment: _frontCardAlignment,</span><br><span class="line">      <span class="comment">// 使用 Transform.rotate 旋转卡片</span></span><br><span class="line">      child: Transform.rotate(</span><br><span class="line">        angle: (pi / <span class="number">180.0</span>) * _frontCardRotation,</span><br><span class="line">        <span class="comment">// 使用 SizedBox 确定卡片尺寸</span></span><br><span class="line">        child: SizedBox.fromSize(</span><br><span class="line">          size: Size(constraints.maxWidth * <span class="number">0.9</span>, constraints.maxHeight * <span class="number">0.9</span>),</span><br><span class="line">          child: Container(</span><br><span class="line">            color: Colors.blue,</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 省略......</span></span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> MaterialApp(</span><br><span class="line">      title: <span class="string">'TCards demo'</span>,</span><br><span class="line">      debugShowCheckedModeBanner: <span class="keyword">false</span>,</span><br><span class="line">      home: Scaffold(</span><br><span class="line">        body: Center(</span><br><span class="line">          child: SizedBox(</span><br><span class="line">            width: <span class="number">300</span>,</span><br><span class="line">            height: <span class="number">400</span>,</span><br><span class="line">            child: LayoutBuilder(</span><br><span class="line">              builder: (context, constraints) &#123;</span><br><span class="line">                <span class="comment">// 使用 LayoutBuilder 获取容器的尺寸，传个子项计算卡片尺寸</span></span><br><span class="line">                Size size = MediaQuery.of(context).size;</span><br><span class="line">                <span class="built_in">double</span> speed = <span class="number">10.0</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> Stack(</span><br><span class="line">                  children: [</span><br><span class="line">                    <span class="comment">// 后面的子项会显示在上面，所以前面的卡片放在最后</span></span><br><span class="line">                    _backCard(constraints),</span><br><span class="line">                    _middleCard(constraints),</span><br><span class="line">                    _frontCard(constraints),</span><br><span class="line">                    <span class="comment">// 使用一个占满父元素的 GestureDetector 监听手指移动</span></span><br><span class="line">                    SizedBox.expand(</span><br><span class="line">                      child: GestureDetector(</span><br><span class="line">                        onPanDown: (DragDownDetails details) &#123;&#125;,</span><br><span class="line">                        onPanUpdate: (DragUpdateDetails details) &#123;</span><br><span class="line">                          <span class="comment">// 手指移动就更新最前面卡片的 alignment 属性</span></span><br><span class="line">                          _frontCardAlignment += Alignment(</span><br><span class="line">                            details.delta.dx / (size.width / <span class="number">2</span>) * speed,</span><br><span class="line">                            details.delta.dy / (size.height / <span class="number">2</span>) * speed,</span><br><span class="line">                          );</span><br><span class="line">                          <span class="comment">// 设置最前面卡片的旋转角度</span></span><br><span class="line">                          _frontCardRotation = _frontCardAlignment.x;</span><br><span class="line">                          <span class="comment">// setState 更新界面</span></span><br><span class="line">                          setState(() &#123;&#125;);</span><br><span class="line">                        &#125;,</span><br><span class="line">                        onPanEnd: (DragEndDetails details) &#123;&#125;,</span><br><span class="line">                      ),</span><br><span class="line">                    ),</span><br><span class="line">                  ],</span><br><span class="line">                );</span><br><span class="line">              &#125;,</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="./images/flutter-tinder-card/pan.gif" width="260" style="width: 280px">

<h2 id="卡片动画"><a href="#卡片动画" class="headerlink" title="卡片动画"></a>卡片动画</h2><p>这个布局有三种动画，最前面卡片移开的动画；后面两张卡片位置和尺寸变化的动画；最前面卡片回到原位的动画。</p>
<ol>
<li>判断卡片横轴移动距离</li>
</ol>
<p>在手指离开屏幕时判断卡片横轴的移动距离，如果最前面的卡片横轴移动距离超过限制就运行换位动画，否则运行回弹动画。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 改变位置的动画</span></span><br><span class="line"><span class="keyword">void</span> _runChangeOrderAnimation() &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 卡片回弹的动画</span></span><br><span class="line"><span class="keyword">void</span> _runReboundAnimation(Offset pixelsPerSecond, Size size) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 省略...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 卡片横轴距离限制</span></span><br><span class="line"><span class="keyword">final</span> <span class="built_in">double</span> limit = <span class="number">10.0</span>;</span><br><span class="line"></span><br><span class="line">SizedBox.expand(</span><br><span class="line">  child: GestureDetector(</span><br><span class="line">    <span class="comment">// 省略...</span></span><br><span class="line">    onPanEnd: (DragEndDetails details) &#123;</span><br><span class="line">      <span class="comment">// 如果最前面的卡片横轴移动距离超过限制就运行换位动画，否则运行回弹动画</span></span><br><span class="line">      <span class="keyword">if</span> (_frontCardAlignment.x &gt; limit ||</span><br><span class="line">          _frontCardAlignment.x &lt; -limit) &#123;</span><br><span class="line">        _runChangeOrderAnimation();</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        _runReboundAnimation(</span><br><span class="line">          details.velocity.pixelsPerSecond,</span><br><span class="line">          size,</span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  ),</span><br><span class="line">),</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>卡片回弹动画</li>
</ol>
<p>首先实现卡片回弹的动画，使用 <code>AnimationController</code> 控制动画，在 <code>initState</code> 初始化动画控制器。创建一个 <code>AlignmentTween</code> 设置动画运动值，起始值是卡片当前位置，最终值是卡片的默认位置。然后将一个弹簧模拟 <code>SpringSimulation</code> 传递给动画控制器，让动画模拟运行。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_MyAppState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">MyApp</span>&gt; <span class="title">with</span> <span class="title">TickerProviderStateMixin</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 省略...</span></span><br><span class="line">  <span class="comment">// 卡片回弹动画</span></span><br><span class="line">  Animation&lt;Alignment&gt; _reboundAnimation;</span><br><span class="line">  <span class="comment">// 卡片回弹动画控制器</span></span><br><span class="line">  AnimationController _reboundController;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 省略...</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 卡片回弹的动画</span></span><br><span class="line">  <span class="keyword">void</span> _runReboundAnimation(Offset pixelsPerSecond, Size size) &#123;</span><br><span class="line">    <span class="comment">// 创建动画值</span></span><br><span class="line">    _reboundAnimation = _reboundController.drive(</span><br><span class="line">      AlignmentTween(</span><br><span class="line">        <span class="comment">// 起始值是卡片当前位置，最终值是卡片的默认位置</span></span><br><span class="line">        begin: _frontCardAlignment,</span><br><span class="line">        end: Alignment(<span class="number">0.0</span>, <span class="number">-0.5</span>),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">    <span class="comment">// 计算卡片运动速度</span></span><br><span class="line">    <span class="keyword">final</span> <span class="built_in">double</span> unitsPerSecondX = pixelsPerSecond.dx / size.width;</span><br><span class="line">    <span class="keyword">final</span> <span class="built_in">double</span> unitsPerSecondY = pixelsPerSecond.dy / size.height;</span><br><span class="line">    <span class="keyword">final</span> unitsPerSecond = Offset(unitsPerSecondX, unitsPerSecondY);</span><br><span class="line">    <span class="keyword">final</span> unitVelocity = unitsPerSecond.distance;</span><br><span class="line">    <span class="comment">// 创建弹簧模拟的定义</span></span><br><span class="line">    <span class="keyword">const</span> spring = SpringDescription(mass: <span class="number">30</span>, stiffness: <span class="number">1</span>, damping: <span class="number">1</span>);</span><br><span class="line">    <span class="comment">// 创建弹簧模拟</span></span><br><span class="line">    <span class="keyword">final</span> simulation = SpringSimulation(spring, <span class="number">0</span>, <span class="number">1</span>, -unitVelocity);</span><br><span class="line">    <span class="comment">// 根据给定的模拟运行动画</span></span><br><span class="line">    _reboundController.animateWith(simulation);</span><br><span class="line">    <span class="comment">// 重置旋转值</span></span><br><span class="line">    _frontCardRotation = <span class="number">0.0</span>;</span><br><span class="line">    setState(() &#123;&#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">    <span class="comment">// 初始化回弹的动画控制器</span></span><br><span class="line">    _reboundController = AnimationController(vsync: <span class="keyword">this</span>)</span><br><span class="line">      ..addListener(() &#123;</span><br><span class="line">        setState(() &#123;</span><br><span class="line">          <span class="comment">// 动画运行时更新最前面卡片的 alignment 属性</span></span><br><span class="line">          _frontCardAlignment = _reboundAnimation.value;</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 省略...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="./images/flutter-tinder-card/rebound.gif" width="536" style="width: 280px">

<ol start="3">
<li>卡片换位动画</li>
</ol>
<p>卡片换位动画就是将最前面的卡片移除可视区，将中间的卡片移动到最前面，将最后的卡片移动到中间，然后新建一个最后面的卡片。在卡片更换位置的同时需要改变卡片的尺寸，位置动画和尺寸动画同时进行。首先定义每个卡片运动时的动画值</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// <span class="markdown">卡片尺寸</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CardSizes</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> Size front(BoxConstraints constraints) &#123;</span><br><span class="line">    <span class="keyword">return</span> Size(constraints.maxWidth * <span class="number">0.9</span>, constraints.maxHeight * <span class="number">0.9</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> Size middle(BoxConstraints constraints) &#123;</span><br><span class="line">    <span class="keyword">return</span> Size(constraints.maxWidth * <span class="number">0.85</span>, constraints.maxHeight * <span class="number">0.9</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> Size back(BoxConstraints constraints) &#123;</span><br><span class="line">    <span class="keyword">return</span> Size(constraints.maxWidth * <span class="number">0.8</span>, constraints.maxHeight * <span class="number">.9</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// <span class="markdown">卡片位置</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CardAlignments</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> Alignment front = Alignment(<span class="number">0.0</span>, <span class="number">-0.5</span>);</span><br><span class="line">  <span class="keyword">static</span> Alignment middle = Alignment(<span class="number">0.0</span>, <span class="number">0.0</span>);</span><br><span class="line">  <span class="keyword">static</span> Alignment back = Alignment(<span class="number">0.0</span>, <span class="number">0.5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// <span class="markdown">卡片运动动画</span></span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CardAnimations</span> </span>&#123;</span><br><span class="line">  <span class="comment">/// <span class="markdown">最前面卡片的消失动画值</span></span></span><br><span class="line">  <span class="keyword">static</span> Animation&lt;Alignment&gt; frontCardDisappearAnimation(</span><br><span class="line">    AnimationController parent,</span><br><span class="line">    Alignment beginAlignment,</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="keyword">return</span> AlignmentTween(</span><br><span class="line">      begin: beginAlignment,</span><br><span class="line">      end: Alignment(</span><br><span class="line">        beginAlignment.x &gt; <span class="number">0</span></span><br><span class="line">            ? beginAlignment.x + <span class="number">30.0</span></span><br><span class="line">            : beginAlignment.x - <span class="number">30.0</span>,</span><br><span class="line">        <span class="number">0.0</span>,</span><br><span class="line">      ),</span><br><span class="line">    ).animate(</span><br><span class="line">      CurvedAnimation(</span><br><span class="line">        parent: parent,</span><br><span class="line">        curve: Interval(<span class="number">0.0</span>, <span class="number">0.5</span>, curve: Curves.easeIn),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">中间卡片位置变换动画值</span></span></span><br><span class="line">  <span class="keyword">static</span> Animation&lt;Alignment&gt; middleCardAlignmentAnimation(</span><br><span class="line">    AnimationController parent,</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="keyword">return</span> AlignmentTween(</span><br><span class="line">      begin: CardAlignments.middle,</span><br><span class="line">      end: CardAlignments.front,</span><br><span class="line">    ).animate(</span><br><span class="line">      CurvedAnimation(</span><br><span class="line">        parent: parent,</span><br><span class="line">        curve: Interval(<span class="number">0.2</span>, <span class="number">0.5</span>, curve: Curves.easeIn),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">中间卡片尺寸变换动画值</span></span></span><br><span class="line">  <span class="keyword">static</span> Animation&lt;Size&gt; middleCardSizeAnimation(</span><br><span class="line">    AnimationController parent,</span><br><span class="line">    BoxConstraints constraints,</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="keyword">return</span> SizeTween(</span><br><span class="line">      begin: CardSizes.middle(constraints),</span><br><span class="line">      end: CardSizes.front(constraints),</span><br><span class="line">    ).animate(</span><br><span class="line">      CurvedAnimation(</span><br><span class="line">        parent: parent,</span><br><span class="line">        curve: Interval(<span class="number">0.2</span>, <span class="number">0.5</span>, curve: Curves.easeIn),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">最后面卡片位置变换动画值</span></span></span><br><span class="line">  <span class="keyword">static</span> Animation&lt;Alignment&gt; backCardAlignmentAnimation(</span><br><span class="line">    AnimationController parent,</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="keyword">return</span> AlignmentTween(</span><br><span class="line">      begin: CardAlignments.back,</span><br><span class="line">      end: CardAlignments.middle,</span><br><span class="line">    ).animate(</span><br><span class="line">      CurvedAnimation(</span><br><span class="line">        parent: parent,</span><br><span class="line">        curve: Interval(<span class="number">0.4</span>, <span class="number">0.7</span>, curve: Curves.easeIn),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/// <span class="markdown">最后面卡片尺寸变换动画值</span></span></span><br><span class="line">  <span class="keyword">static</span> Animation&lt;Size&gt; backCardSizeAnimation(</span><br><span class="line">    AnimationController parent,</span><br><span class="line">    BoxConstraints constraints,</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="keyword">return</span> SizeTween(</span><br><span class="line">      begin: CardSizes.back(constraints),</span><br><span class="line">      end: CardSizes.middle(constraints),</span><br><span class="line">    ).animate(</span><br><span class="line">      CurvedAnimation(</span><br><span class="line">        parent: parent,</span><br><span class="line">        curve: Interval(<span class="number">0.4</span>, <span class="number">0.7</span>, curve: Curves.easeIn),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用一个 <code>AnimationController</code> 控制动画运行，动画运行时在卡片上应用以上的动画值，否则使用卡片默认的位置和尺寸。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_MyAppState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">MyApp</span>&gt; <span class="title">with</span> <span class="title">TickerProviderStateMixin</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 省略...</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 卡片位置变换动画控制器</span></span><br><span class="line">  AnimationController _cardChangeController;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//  前面的卡片，使用 Align 定位</span></span><br><span class="line">  Widget _frontCard(BoxConstraints constraints) &#123;</span><br><span class="line">    <span class="comment">// 判断动画是否在运行</span></span><br><span class="line">    <span class="built_in">bool</span> forward = _cardChangeController.status == AnimationStatus.forward;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用 Transform.rotate 旋转卡片</span></span><br><span class="line">    Widget rotate = Transform.rotate(</span><br><span class="line">      angle: (pi / <span class="number">180.0</span>) * _frontCardRotation,</span><br><span class="line">      <span class="comment">// 使用 SizedBox 确定卡片尺寸</span></span><br><span class="line">      child: SizedBox.fromSize(</span><br><span class="line">        size: CardSizes.front(constraints),</span><br><span class="line">        child: Container(</span><br><span class="line">          color: Colors.blue,</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 在动画运行时使用动画值</span></span><br><span class="line">    <span class="keyword">if</span> (forward) &#123;</span><br><span class="line">      <span class="keyword">return</span> Align(</span><br><span class="line">        alignment: CardAnimations.frontCardDisappearAnimation(</span><br><span class="line">          _cardChangeController,</span><br><span class="line">          _frontCardAlignment,</span><br><span class="line">        ).value,</span><br><span class="line">        child: rotate,</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 否则使用默认值</span></span><br><span class="line">    <span class="keyword">return</span> Align(</span><br><span class="line">      alignment: _frontCardAlignment,</span><br><span class="line">      child: rotate,</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 中间的卡片，使用 Align 定位</span></span><br><span class="line">  Widget _middleCard(BoxConstraints constraints) &#123;</span><br><span class="line">    <span class="comment">// 判断动画是否在运行</span></span><br><span class="line">    <span class="built_in">bool</span> forward = _cardChangeController.status == AnimationStatus.forward;</span><br><span class="line">    Widget child = Container(color: Colors.red);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 在动画运行时使用动画值</span></span><br><span class="line">    <span class="keyword">if</span> (forward) &#123;</span><br><span class="line">      <span class="keyword">return</span> Align(</span><br><span class="line">        alignment: CardAnimations.middleCardAlignmentAnimation(</span><br><span class="line">          _cardChangeController,</span><br><span class="line">        ).value,</span><br><span class="line">        child: SizedBox.fromSize(</span><br><span class="line">          size: CardAnimations.middleCardSizeAnimation(</span><br><span class="line">            _cardChangeController,</span><br><span class="line">            constraints,</span><br><span class="line">          ).value,</span><br><span class="line">          child: child,</span><br><span class="line">        ),</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 否则使用默认值</span></span><br><span class="line">    <span class="keyword">return</span> Align(</span><br><span class="line">      alignment: CardAlignments.middle,</span><br><span class="line">      child: SizedBox.fromSize(</span><br><span class="line">        size: CardSizes.middle(constraints),</span><br><span class="line">        child: child,</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 后面的卡片，使用 Align 定位</span></span><br><span class="line">  Widget _backCard(BoxConstraints constraints) &#123;</span><br><span class="line">    <span class="comment">// 判断动画是否在运行</span></span><br><span class="line">    <span class="built_in">bool</span> forward = _cardChangeController.status == AnimationStatus.forward;</span><br><span class="line">    Widget child = Container(color: Colors.green);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 在动画运行时使用动画值</span></span><br><span class="line">    <span class="keyword">if</span> (forward) &#123;</span><br><span class="line">      <span class="keyword">return</span> Align(</span><br><span class="line">        alignment: CardAnimations.backCardAlignmentAnimation(</span><br><span class="line">          _cardChangeController,</span><br><span class="line">        ).value,</span><br><span class="line">        child: SizedBox.fromSize(</span><br><span class="line">          size: CardAnimations.backCardSizeAnimation(</span><br><span class="line">            _cardChangeController,</span><br><span class="line">            constraints,</span><br><span class="line">          ).value,</span><br><span class="line">          child: child,</span><br><span class="line">        ),</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 否则使用默认值</span></span><br><span class="line">    <span class="keyword">return</span> Align(</span><br><span class="line">      alignment: CardAlignments.back,</span><br><span class="line">      child: SizedBox.fromSize(</span><br><span class="line">        size: CardSizes.back(constraints),</span><br><span class="line">        child: child,</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 改变位置的动画</span></span><br><span class="line">  <span class="keyword">void</span> _runChangeOrderAnimation() &#123;</span><br><span class="line">    _cardChangeController.reset();</span><br><span class="line">    _cardChangeController.forward();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 省略...</span></span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">    <span class="comment">// 省略...</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化卡片换位动画控制器</span></span><br><span class="line">    _cardChangeController = AnimationController(</span><br><span class="line">      duration: <span class="built_in">Duration</span>(milliseconds: <span class="number">1000</span>),</span><br><span class="line">      vsync: <span class="keyword">this</span>,</span><br><span class="line">    )</span><br><span class="line">      ..addListener(() =&gt; setState(() &#123;&#125;))</span><br><span class="line">      ..addStatusListener((status) &#123;</span><br><span class="line">        <span class="keyword">if</span> (status == AnimationStatus.completed) &#123;</span><br><span class="line">          <span class="comment">// 动画运行结束后重置位置和旋转</span></span><br><span class="line">          _frontCardRotation = <span class="number">0.0</span>;</span><br><span class="line">          _frontCardAlignment = CardAlignments.front;</span><br><span class="line">          setState(() &#123;&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 省略...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="./images/flutter-tinder-card/foward.gif" width="260" style="width: 280px">

<h2 id="数据更新"><a href="#数据更新" class="headerlink" title="数据更新"></a>数据更新</h2><p>可以看到动画运行之后三张卡片都恢复了默认的位置和尺寸，而需要的效果是当卡片换位动画完成后三张卡片的数据会改变，所以还需要在动画之后进行数据处理。</p>
<p>创建一个数组保存全部子项目，使用一个索引更新最前面卡片的子项索引，在卡片换位动画结束后索引值加一。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; images = [</span><br><span class="line">  <span class="string">'https://gank.io/images/5ba77f3415b44f6c843af5e149443f94'</span>,</span><br><span class="line">  <span class="string">'https://gank.io/images/02eb8ca3297f4931ab64b7ebd7b5b89c'</span>,</span><br><span class="line">  <span class="string">'https://gank.io/images/31f92f7845f34f05bc10779a468c3c13'</span>,</span><br><span class="line">  <span class="string">'https://gank.io/images/b0f73f9527694f44b523ff059d8a8841'</span>,</span><br><span class="line">  <span class="string">'https://gank.io/images/1af9d69bc60242d7aa2e53125a4586ad'</span>,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 生成卡片数组</span></span><br><span class="line"><span class="built_in">List</span>&lt;Widget&gt; cards = <span class="built_in">List</span>.generate(</span><br><span class="line">  images.length,</span><br><span class="line">  (<span class="built_in">int</span> index) &#123;</span><br><span class="line">    <span class="keyword">return</span> Container(</span><br><span class="line">      decoration: BoxDecoration(</span><br><span class="line">        color: Colors.white,</span><br><span class="line">        borderRadius: BorderRadius.circular(<span class="number">16.0</span>),</span><br><span class="line">        boxShadow: [</span><br><span class="line">          BoxShadow(</span><br><span class="line">            offset: Offset(<span class="number">0</span>, <span class="number">17</span>),</span><br><span class="line">            blurRadius: <span class="number">23.0</span>,</span><br><span class="line">            spreadRadius: <span class="number">-13.0</span>,</span><br><span class="line">            color: Colors.black54,</span><br><span class="line">          )</span><br><span class="line">        ],</span><br><span class="line">      ),</span><br><span class="line">      child: ClipRRect(</span><br><span class="line">        borderRadius: BorderRadius.circular(<span class="number">16.0</span>),</span><br><span class="line">        child: Image.network(</span><br><span class="line">          images[index],</span><br><span class="line">          fit: BoxFit.cover,</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  <span class="comment">// 使用生成的卡片数组</span></span><br><span class="line">  runApp(MyApp(cards: cards));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">List</span>&lt;Widget&gt; cards;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> MyApp(&#123;<span class="meta">@required</span> <span class="keyword">this</span>.cards&#125;);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  _MyAppState createState() =&gt; _MyAppState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_MyAppState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">MyApp</span>&gt; <span class="title">with</span> <span class="title">TickerProviderStateMixin</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 卡片列表</span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">List</span>&lt;Widget&gt; _cards = [];</span><br><span class="line">  <span class="comment">// 最前面卡片的索引</span></span><br><span class="line">  <span class="built_in">int</span> _frontCardIndex = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 省略...</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//  前面的卡片，使用 Align 定位</span></span><br><span class="line">  Widget _frontCard(BoxConstraints constraints) &#123;</span><br><span class="line">    <span class="comment">// 判断是否还有卡片</span></span><br><span class="line">    Widget card =</span><br><span class="line">        _frontCardIndex &lt; _cards.length ? _cards[_frontCardIndex] : Container();</span><br><span class="line">    <span class="built_in">bool</span> forward = _cardChangeController.status == AnimationStatus.forward;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用 Transform.rotate 旋转卡片</span></span><br><span class="line">    Widget rotate = Transform.rotate(</span><br><span class="line">      angle: (pi / <span class="number">180.0</span>) * _frontCardRotation,</span><br><span class="line">      <span class="comment">// 使用 SizedBox 确定卡片尺寸</span></span><br><span class="line">      child: SizedBox.fromSize(</span><br><span class="line">        size: CardSizes.front(constraints),</span><br><span class="line">        <span class="comment">// 使用数组中的子项</span></span><br><span class="line">        child: card,</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">   <span class="comment">// 省略...</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 中间的卡片，使用 Align 定位</span></span><br><span class="line">  Widget _middleCard(BoxConstraints constraints) &#123;</span><br><span class="line">    <span class="comment">// 判断是否还有两张卡片</span></span><br><span class="line">    Widget card = _frontCardIndex &lt; _cards.length - <span class="number">1</span></span><br><span class="line">        ? _cards[_frontCardIndex + <span class="number">1</span>]</span><br><span class="line">        : Container();</span><br><span class="line">    <span class="comment">// 省略...</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 后面的卡片，使用 Align 定位</span></span><br><span class="line">  Widget _backCard(BoxConstraints constraints) &#123;</span><br><span class="line">    <span class="comment">// 判断数组中是否还有三张卡片</span></span><br><span class="line">    Widget card = _frontCardIndex &lt; _cards.length - <span class="number">2</span></span><br><span class="line">        ? _cards[_frontCardIndex + <span class="number">2</span>]</span><br><span class="line">        : Container();</span><br><span class="line">    <span class="comment">// 省略...</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 省略...</span></span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">    <span class="comment">// 初始化卡片数组</span></span><br><span class="line">    _cards.addAll(widget.cards);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 省略...</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化卡片换位动画控制器</span></span><br><span class="line">    _cardChangeController = AnimationController(</span><br><span class="line">      duration: <span class="built_in">Duration</span>(milliseconds: <span class="number">1000</span>),</span><br><span class="line">      vsync: <span class="keyword">this</span>,</span><br><span class="line">    )</span><br><span class="line">      ..addListener(() =&gt; setState(() &#123;&#125;))</span><br><span class="line">      ..addStatusListener((status) &#123;</span><br><span class="line">        <span class="keyword">if</span> (status == AnimationStatus.completed) &#123;</span><br><span class="line">          <span class="comment">// 动画结束后将最前面卡片的索引向前移动一位</span></span><br><span class="line">          _frontCardIndex++;</span><br><span class="line">          <span class="comment">// 动画运行结束后重置位置和旋转</span></span><br><span class="line">          _frontCardRotation = <span class="number">0.0</span>;</span><br><span class="line">          _frontCardAlignment = CardAlignments.front;</span><br><span class="line">          setState(() &#123;&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">// 省略...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> Stack(</span><br><span class="line">  children: [</span><br><span class="line">    <span class="comment">// 省略...</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用一个占满父元素的 GestureDetector 监听手指移动</span></span><br><span class="line">    <span class="comment">// 如果动画在运行中就不在响应手势</span></span><br><span class="line">    _cardChangeController.status != AnimationStatus.forward</span><br><span class="line">        ? SizedBox.expand(</span><br><span class="line">            child: GestureDetector(</span><br><span class="line">              <span class="comment">// 省略...</span></span><br><span class="line">            )</span><br><span class="line">          )</span><br><span class="line">        : IgnorePointer(),</span><br><span class="line">  ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>至此整个布局就实现了 🎉</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>这个布局的关键点在于</p>
<ol>
<li>三张卡片的定位</li>
<li>监听手势更新最前面卡片的位置</li>
<li>卡片的换位动画和回弹动画</li>
</ol>
<p>作者已经封装了这个插件，地址是 <a href="https://pub.dev/packages/tcard" target="_blank" rel="noopener">https://pub.dev/packages/tcard</a> 欢迎使用。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://api.flutter.dev/flutter/widgets/Stack-class.html" target="_blank" rel="noopener">Stack class</a></p>
<p><a href="https://github.com/Ivaskuu/tinder_cards" target="_blank" rel="noopener">tinder_cards</a></p></section>

  <a
  class="license-link"
  rel="license"
  href="https://creativecommons.org/licenses/by-nc-sa/4.0/legalcode.zh-Hans"
>
  <img
    class="license-img"
    alt="知识共享许可协议"
    src="https://img.shields.io/badge/license-BY--NC--SA%204.0-green"
  />
</a>

  <section class="article-more">
    
    <a
      class=""
      href="/post/2020/07/07/flutter-generative-artistry-01/"
      title="Flutter 绘制瓷砖线 Tiled Lines"
    >
      &larr;&nbsp;Flutter 绘制瓷砖线 Tiled Lines
    </a>
     
    <a
      class=""
      href="/post/2020/06/17/leetcode-1014/"
      title="最好的你"
    >
      最好的你&nbsp;&rarr;
    </a>
    
  </section>
</article></main>
    <footer class="footer container">
  <ul class="sns-list">
    <li class="sns-list-item">
      <p class="">
        共计&#58; 61 篇
      </p>
    </li>
    <li class="sns-list-item">
      <p class="">
        <span class=""
          >总字数&#58; 63.9k</span
        >
      </p>
    </li>
  </ul>

  <ul class="sns-list">
    
    <li class="sns-list-item">
      <a
        class="sns-list-link"
        target="_blank"
        rel="noopener"
        href="https://github.com/xrr2016"
        >Github</a
      >
    </li>
     
    <li class="sns-list-item">
      <a
        class="sns-list-link"
        target="_blank"
        rel="noopener"
        href="https://juejin.im/user/576666b7207703006b1e0f09"
        >掘金</a
      >
    </li>
     
    <li class="sns-list-item">
      <a
        class="sns-list-link"
        target="_blank"
        rel="noopener"
        href="https://zhihu.com/people/needforchange/posts"
        >知乎</a
      >
    </li>
     
    <li>
      <a
        class="sns-list-link"
        target="_blank"
        rel="noopener"
        href="https://leetcode-cn.com/u/coldstone"
        >力扣</a
      >
    </li>
    
    <li class="sns-list-item">
      <a class="rss-link" href="/atom.xml">
        <svg
          class=""
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 5c7.18 0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z"
          />
        </svg>
      </a>
    </li>
  </ul>

  <ul class="sns-list">
    <li class="sns-list-item">
      <a
        class="sns-list-link"
        href="https://colmugx.github.io/blog/"
        target="_blank"
        >colmugx</a
      >
    </li>
    <li class="sns-list-item">
      <a class="sns-list-link" href="https://kalasearch.cn/blog" target="_blank"
        >卡拉搜索</a
      >
    </li>
    <li class="sns-list-item">
      <a class="sns-list-link" href="https://blog.inmind.ltd/" target="_blank"
        >Mind's blog</a
      >
    </li>
    <li class="sns-list-item">
      <a
        class="sns-list-link"
        href="https://oldchen.top/flutter-blog/#/"
        target="_blank"
        >老晨子</a
      >
    </li>
    <li class="sns-list-item">
      <a class="sns-list-link" href="https://www.v2fy.com/" target="_blank"
        >猫爪导航🐱</a
      >
    </li>
    <li class="sns-list-item">
      <a class="sns-list-link" href="https://wxsm.space" target="_blank"
        >wxsm's space</a
      >
    </li>
  </ul>
</footer>
 <!--
 Copyright (c) 2021 Cold Stone
 
 This software is released under the MIT License.
 https://opensource.org/licenses/MIT
-->
<script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.7.2/build/highlight.min.js"></script>
<script src="/index.js"></script>

  </body>
</html>
